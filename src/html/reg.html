<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>会员注册页面_健一网</title>
	<script src="../lib/jquery-1.10.1.min.js"></script>
	<script src="../js/common.js"></script>
	<link rel="stylesheet" href="../css/base.css">
	<link rel="stylesheet" href="../css/reg.css">
	<link rel="stylesheet" href="../css/reg.1.css">
</head>

<body>
	<div class="rm1000">
		<div class="logo-main">
			<a title="华润集团健一网网上药店" target="_blank" href="../html/index01.html" class="logoj1"><img width="200"
					height="39" alt="健一网网上药店" src="https://passport.j1.com/images/j1lg.png"></a>

			<h2>会员注册</h2>

			<p>
				注册成功即可获得<span class="fc4">100</span>积分+<span class="fc4">会员特权</span>！
			</p>
		</div>

		<div class="registermain">
			<div class="font_box">
				<div class="input_box">
					<form action="">
						<p><span class="label">手机号</span> <input type="tel" autocomplete="off" value="" id="tel"
								placeholder="请输入您的手机号"> <span class="inf"></span></p>
						<p><span class="label">验证码</span> <input type="text" autocomplete="off" value="" id="repetition"
								placeholder="请输入验证码(区分大小写)"> <span class="yanzheng"></span> <a class="dianji"
								href="##">看不清换一张</a> <span class="inf"></span></p>
						<p><span class="label">设置密码</span> <input type="password" value="" id="password"
								placeholder="6-18位首字母开头（区分大小写）"> <span class="inf"></span></p>
						<p><span class="label">确认密码</span> <input type="password" value="" id="affirm"
								placeholder="密码请保持一致"> <span class="inf"></span></p>
					</form>
				</div>
				<div class="firm"><input type="button" value="立即注册" id="btn"></div>
				<div class="agree"><input type="checkbox" name="" id="check"> <span>我已阅读并同意</span> <a href="">《用户协议》</a>
				</div>
				<p class="mess">请同意相关协议</p>
				<div class="success">
					<h3>注册成功</h3>
					<div><input type="button" id="btns" value="去登陆"></div><span class="close">X</span>
				</div>
			</div>
			<!-- 右边 -->
			<div class="rgfr265">
				<h4 class="fs14">已有健一账号？</h4>
				<a class="btn-ksdl" href="./login.html" target="_blank">快速登录</a>
				<h4>使用合作账号登录健一网</h4>
				<ul class="hzzh">
					<li class="hz-01" style="font-size: 13px; color: #676767;">支付宝</li>
					<li class="hz-02" style="font-size: 13px; color: #676767;">QQ</li>
					<li class="hz-03" style="font-size: 13px; color: #676767;">平安健康商圈 健康卡</li>
				</ul>
				<ul>
					<li>
						<a href="javascript:void(0);" onclick="openHrtWindow();"
							style="width: 100px;height: 20px;position: relative;;display:block;">
							<img src="https://passport.j1.com/images/hrtLogin2.png"
								style="width:25px;margin-top: 0px;margin-left: -5px;">
							<span
								style="position: absolute;right: 40px;top:6px;font-size: 13px; color: #676767;">华润通</span>
						</a>
					</li>
					<li>
						<a href="javascript:void(0);" onclick="openTPWindow();"
							style="width: 125px;height: 20px;margin-top: 5px;position: relative;;display:block;">
							<img src="https://passport.j1.com/images/tp.png"
								style="width:20px;margin-top: 5px;margin-left: -5px;">
							<span
								style="position: absolute;right: 40px;top:6px;font-size: 13px; color: #676767;">健钇健康卡</span>
						</a>
					</li>
					<li>
						<a href="javascript:void(0);" onclick="zhebLogin('index');"
							style="width: 110px;height: 20px;margin-top: 5px;position: relative;;display:block;">
							<img src="https://passport.j1.com/images/Ebao.png"
								style="width:25px;margin-top: 5px;margin-left: -5px;">
							<span
								style="position: absolute;right: 40px;top:6px;font-size: 13px; color: #676767;">智慧E保</span>
						</a>
					</li>
				</ul>
			</div>
		</div>



		<div class="sec-footer">
			<div class="zhengshu">
				<a rel="nofollow" href="">互联网药品交易服务资格证书</a>&nbsp;&nbsp;<a rel="nofollow"
					href="">药品经营许可证</a>&nbsp;&nbsp;<a rel="nofollow" href="">互联网药品信息服务资格证书</a>&nbsp;&nbsp;<a
					rel="nofollow" href="">食品流通许可证</a>&nbsp;&nbsp;<a rel="nofollow"
					href="">医疗器械经营企业许可证</a>&nbsp;&nbsp;<a rel="nofollow" href="">药品经营质量管理规范认证证书（新）</a><br>
				<a rel="nofollow" href="">互联网医疗保健信息服务审核同意书</a>&nbsp;&nbsp;<a rel="nofollow"
					href="">信用资质等级评定</a>&nbsp;&nbsp;<a rel="nofollow" href="">信用资质等级证书</a>&nbsp;&nbsp;<a rel="nofollow"
					href="">企业法人营业执照</a>&nbsp;&nbsp;<a rel="nofollow" href="">税务登记证</a>
			</div>

			<div>Copyright © j1.com All rights reserved 沪ICP备09007253号
				上海健一网大药房连锁经营有限公司
			</div>
		</div>

	</div>
	<div id="tie" style="margin-left:-2px;width:357px" class="dropDiv"></div>
</body>
<script>
	(function () {
		let isok1 = false; //手机验证开关
		let isok2 = false; //随机验证码开关
		let isok3 = false; //短信验证开关
		let isok4 = false; //设置密码开关
		let isok5 = false; //确认密码开关
		//手机号验证
		$('#tel').blur(function () {
			if ($('#tel').val()) {
				$.ajax({
					type: 'get',
					url: '../api/reg.php',
					data: 'tel=' + $('#tel').val(),
					success: function (str) {
						if (str == '0') {
							let str1 = $('#tel').val();
							let reg = /^1[3-9]\d{9}$/;
							let ok = reg.test(str1);
							if (ok) {
								$('form .inf').eq(0).html('可注册').css('color', '#58bc58');
								$('#tel').css('border-color', '#58bc58');
								isok1 = true;
							} else {
								$('form .inf').eq(0).html('手机号错误').css('color', 'red');
								$('#tel').css('border-color', 'red')
								isok1 = false;
							}
						} else {
							$('form .inf').eq(0).html('已注册').css('color', 'red');
							$('#tel').css('border-color', 'red');
							isok1 = false;
						}
					}
				})
			} else {
				$('form .inf').eq(0).html('请输入手机号').css('color', 'red');
				$('#tel').css('border-color', 'red');
				isok1 = false;
			}
		})

		//验证码
		$('.yanzheng').html(randomNum()); //初始化验证码随机数
		$('#repetition').blur(function () {
			if ($('#repetition').val()) {
				if ($('#repetition').val() == $('.yanzheng').html()) {
					$('form .inf').eq(1).html('通过').css('color', '#58bc58');
					$('#repetition').css('border-color', '#58bc58');
					isok2 = true;
				} else {
					$('form .inf').eq(1).html('验证码错误').css('color', 'red');
					$('#repetition').css('border-color', 'red').val('');
					$('.yanzheng').html(randomNum());
					isok2 = false;
				}
			} else {
				$('form .inf').eq(1).html('请输入验证码').css('color', 'red');
				$('#repetition').css('border-color', 'red');
				isok2 = false;
			}
		})
		//点击切换随机验证码
		$('.dianji').click(function () {
			$('.yanzheng').html(randomNum());
		})


		//短信验证码

		// $('.suiji').click(function () {
		// 	if ($('#tel').val() == '') {
		// 		alert('请先填写手机号');
		// 		$('#tel').focus();
		// 	} else {
		// 		$.ajax({
		// 			type: 'post',
		// 			url: '../api/phone.php',
		// 			data: 'userphone=' + $('#tel').val(),
		// 			success: function (str) {
		// 				console.log(str);
		// 				let arr = JSON.parse(str);
		// 				$('#note').blur(function () {
		// 					if ($('#note').val() == arr.phonecode) {
		// 						$('form .inf').eq(2).html('匹配').css('color', '#58bc58');
		// 						$('#note').css('border-color', '#58bc58');
		// 						isok3 = true;
		// 					} else {
		// 						$('form .inf').eq(2).html('不匹配').css('color', 'red');
		// 						$('#note').css('border-color', 'red');
		// 						isok3 = false;
		// 					}
		// 				})
		// 				let times = 30;
		// 				let timer = setInterval(CountDown, 1000);

		// 				function CountDown() {
		// 					$('.suiji').html(times + 's后重试').attr('disabled', 'disabled').css({
		// 						'border-color': '#ccc'
		// 					}, {
		// 						'color': '#ccc'
		// 					})
		// 					times--;
		// 					if (times < 0) {
		// 						$('.suiji').html('获取短信验证码').css({
		// 							'border-color': 'orangered'
		// 						}, {
		// 							'color': 'orangered'
		// 						}).removeAttr('disabled');
		// 						clearInterval(timer);
		// 						times = 30;
		// 					}
		// 				}
		// 			}
		// 		})
		// 	}
		// })

		//设置密码
		$('#password').blur(function () {
			if ($('#password').val()) {
				let str = $('#password').val();
				let reg = /^[a-zA-Z]\w{5,17}$/;
				let ok = reg.test(str);
				if (ok) {
					$('form .inf').eq(3).html('通过').css('color', '#58bc58');
					$('#password').css('border-color', '#58bc58');
					isok4 = true;
				} else {
					$('form .inf').eq(3).html('密码格式错误').css('color', 'red');
					$('#password').css('border-color', 'red');
					isok4 = false;
				}
			} else {
				$('form .inf').eq(3).html('请设置密码').css('color', 'red');
				$('#password').css('border-color', 'red');
				isok4 = false;
			}
		})
		//反向验证
		$('#password').bind('input propertychange', function () {
			if ($('#affirm').val() !== '') {
				if ($('#affirm').val() !== $('#password').val()) {
					$('form .inf').eq(4).html('两次密码不同').css('color', 'red');
					$('#affirm').css('border-color', 'red');
				}
			}
		})

		//验证密码
		$('#affirm').bind('input propertychange', function () {
			if ($('#affirm').val()) {
				if ($('#affirm').val() == $('#password').val()) {
					$('form .inf').eq(4).html('通过').css('color', '#58bc58');
					$('#affirm').css('border-color', '#58bc58');
					isok5 = true;
				} else {
					$('form .inf').eq(4).html('两次密码不同').css('color', 'red');
					$('#affirm').css('border-color', 'red');
					isok5 = false;
				}
			} else {
				$('form .inf').eq(4).html('请确认密码').css('color', 'red');
				$('#affirm').css('border-color', 'red');
				isok5 = false;
			}

		})


		//阅读按钮
		$('.mess').show();
		$('#check').click(function () {
			let ischeck = $(this).prop("checked");
			if (ischeck) {
				$('.mess').hide();
			} else {
				$('.mess').show();
			}
		})


		//注册按钮
		$('#btn').click(function () {
			if (isok1 && isok2 && isok4 && isok5 && $('#check').prop('checked')) {
				if ($('#tel').val() && $('#affirm').val()) {
					$.ajax({
						type: "post",
						url: '../api/reg.php',
						data: 'tel=' + $('#tel').val() + '&password=' + $('#affirm').val(),
						success: function (str) {
							console.log(str);
							$('.success').show();
						}
					})
				}
			} else {
				alert('请填写完整信息(记得阅读条款否则无法注册)');
				$('.success').hide();
			}
		})

		$('#btns').click(function () {
			window.open('login.html');
		})
		$('.close').click(function () {
			$('.success').hide();
			location.reload();
		})
	})();
</script>

</html>